#+TITLE: Notebook


#+begin_src ipython :session
%load_ext autoreload
%autoreload 2
#+end_src

#+RESULTS:
: # Out[1]:

#+begin_src ipython :session
import generated.notification.protocol_pb2 as proto
#+end_src

#+RESULTS:
: # Out[2]:

#+begin_src ipython :session
from kafka import KafkaProducer

topic = "crawler-requests"

producer = KafkaProducer(bootstrap_servers="localhost:9092")
#+end_src

#+RESULTS:
: # Out[3]:


#+begin_src ipython :session
request = proto.Request()
request.crawl.requestId = "1234"
request.crawl.url = "duckduckgo.com/?q=test"
request.crawl.jobId = "1234"
request.crawl.query.keywords.append("test")
request.crawl.query.operator = proto.Query.Operator.OR

producer.send(topic, request.SerializeToString()).get(timeout=60)
#+end_src

#+RESULTS:
: # Out[33]:
: : RecordMetadata(topic='crawler-requests', partition=0, topic_partition=TopicPartition(topic='crawler-requests', partition=0), offset=2, timestamp=1606569574230, checksum=3017464133, serialized_key_size=-1, serialized_value_size=48, serialized_header_size=-1)
